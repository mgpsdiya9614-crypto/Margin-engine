import streamlit as st
import pandas as pd
from engine import process_csv

st.set_page_config(page_title="Margin Engine", layout="wide")

st.title("ðŸ“Š Margin Protection Engine")
st.write("Upload your sales CSV to detect profit leaks.")

uploaded_file = st.file_uploader("Upload CSV File", type=["csv"])

if uploaded_file is not None:
    df = pd.read_csv(uploaded_file)
    
    st.subheader("Raw Data Preview")
    st.dataframe(df.head())

    processed_df = process_csv(df)

    st.subheader("Processed Data")
    st.dataframe(processed_df)

    csv = processed_df.to_csv(index=False).encode('utf-8')

    st.download_button(
        label="Download Processed CSV",
        data=csv,
        file_name="processed_margin_data.csv",
        mime="text/csv",
    )

